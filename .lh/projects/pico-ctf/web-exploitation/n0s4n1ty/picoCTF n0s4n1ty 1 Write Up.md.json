{
    "sourceFile": "projects/pico-ctf/web-exploitation/n0s4n1ty/picoCTF n0s4n1ty 1 Write Up.md",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 2,
            "patches": [
                {
                    "date": 1750649689756,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1750649698059,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,5 +1,5 @@\n-﻿##  CTF Name: PIE TIME (Easy)\n+##  CTF Name: PIE TIME (Easy)\n \n ### Description:\n A developer has added profile picture upload functionality to a website. However, the implementation is flawed, and it presents an opportunity for you. Your mission, should you choose to accept it, is to navigate to the provided web page and locate the file upload area. Your ultimate goal is to find the hidden flag located in the `/root` directory.\n \n"
                },
                {
                    "date": 1750649706593,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,5 +1,5 @@\n-﻿##  CTF Name: PIE TIME (Easy)\n+##  CTF Name: PIE TIME (Easy)\n \n ### Description:\n A developer has added profile picture upload functionality to a website. However, the implementation is flawed, and it presents an opportunity for you. Your mission, should you choose to accept it, is to navigate to the provided web page and locate the file upload area. Your ultimate goal is to find the hidden flag located in the `/root` directory.\n \n"
                }
            ],
            "date": 1750649689756,
            "name": "Commit-0",
            "content": "##  CTF Name: PIE TIME (Easy)\n\n### Description:\nA developer has added profile picture upload functionality to a website. However, the implementation is flawed, and it presents an opportunity for you. Your mission, should you choose to accept it, is to navigate to the provided web page and locate the file upload area. Your ultimate goal is to find the hidden flag located in the `/root` directory.\n\n### Hint:\n1. File upload was not sanitized\n2. Whenever you get a shell on a remote machine, check `sudo -l`\n\n### Analysis:\nThis challenge demonstrates a common backend misconfiguration: the file upload form accepts files without filtering by type or extension, allowing the attacker to upload a simple PHP web shell. By accessing the uploaded shell via the browser, we gain remote code execution on the server. Once inside, we find that the `www-data` user has `sudo` privileges with `NOPASSWD`, meaning we can escalate privileges without needing a password and directly read the root-only flag file.\n\n### Solution:\n1. **Create and upload a PHP web shell:**\n    \n    Example shell code:\n    ![f]()\n\n    \n    ![f](./)\n2. **Access the shell and run commands:**\n``http://.../uploads/shell.php?cmd=id``\n![f]()\n\n3. **Check sudo privileges:**\n``?cmd=sudo -l\n``\n![f]()\n4. **Read the flag:**\n``?cmd=sudo ls /root\n`` \n``?cmd=sudo cat /root/flag.txt\n``\n![f]()\n![f]()\n\n\n### Flag:\n**picoCTF{wh47_c4n_u_d0_wPHP_f7424fc7}**\n"
        }
    ]
}