{
    "sourceFile": "projects/POC_Bug-Bounty/Broken Acces Control Write Up.md",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 0,
            "patches": [
                {
                    "date": 1750645371783,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                }
            ],
            "date": 1750645371782,
            "name": "Commit-0",
            "content": "# **Broken Access Control Vulnerability Report**\r\n**Tools Used : Burp Suite, FoxyProxy, Firefox Multi-Account Containers**\r\n\r\n### **Apa itu Broken Access Control (BAC)?**\r\n\r\n![f](./documetation/bac.png)\r\n\r\n**Broken Access Control** terjadi ketika sistem gagal memvalidasi izin pengguna, memungkinkan akses ke resource yang seharusnya dibatasi. Kerentanan ini masuk **OWASP Top 10** karena memungkinkan:\r\n\r\n-   **IDOR** : Manipulasi parameter (e.g., `user_id=123`) untuk mengakses data orang lain.\r\n-   **Privilege Escalation** : Pengguna biasa bisa melakukan aksi admin (e.g., hapus grup, ubah role).\r\n\r\n### **Persiapan Testing**\r\n\r\n**1. Siapkan 3 Akun** :\r\n\r\n-   **Attacker** : Akun untuk melakukan exploitasi.\r\n-   **Victim1** : Akun target utama (pemilik grup yang akan dimanipulasi).\r\n-   **Victim2** : Akun tambahan (opsional, untuk testing penambahan/penghapusan anggota).\r\n\r\n**2. Login dengan Firefox Multi-Account Containers** :\r\n\r\n-   Buka Firefox dan pasang ekstensi **Multi-Account Containers** .\r\n-   Buat 3 container berbeda untuk memisahkan sesi:\r\n    \r\n    -   Container **Merah** untuk Attacker.\r\n    -   Container **Biru** untuk Victim1.\r\n    -   Container **Hijau** untuk Victim2.\r\n    \r\n-   Login ke masing-masing akun di container yang sesuai.\r\n    -   Screenshot: Tampilan 3 container dengan akun terpisah.\r\n    \r\n        <br>\r\n\r\n        ![attacker](./documetation/Screenshot%20(446).png)\r\n        \r\n        <br>\r\n\r\n        ![victim1](./documetation/Screenshot%20(447).png) \r\n\r\n        <br>\r\n    \r\n        ![victim2](./documetation/Screenshot%20(448).png) \r\n\r\n**3. Konfigurasi Proxy** :\r\n\r\n-   Aktifkan **FoxyProxy** untuk mengarahkan traffic ke Burp Suite.\r\n-   Pastikan semua request dari ketiga container melalui Burp Suite.\r\n\r\n<br>\r\n<br>\r\n\r\n## **1. Privilege Escalation - Clear Chat**\r\n\r\n**Endpoint** : `/clear-chat`  \r\n**Severity** : High\r\n\r\n### **Steps to Reproduce** :\r\n\r\n1.  **Victim Membuat Grup**\r\n    \r\n    -   Victim membuat grup baru dan mengundang attacker sebagai anggota.\r\n    <br>\r\n    <br>\r\n    -   Screenshot: Victim mengundang attacker ke grup\r\n    <br>\r\n    ![f](./documetation/images.png)\r\n    \r\n2.  **Intercept Request Clear Chat**\r\n   \r\n    -   Victim membuka grup, lalu lakukan clear chat.\r\n    -   Tangkap request menggunakan Burp Suite dan simpan di Repeater dengan nama **\"victim_clear_chat\"** .\r\n    <br>\r\n    <br>\r\n    -   Screenshot: Request clear chat dari victim di Burp Repeater.\r\n    <br>\r\n    ![f](./documetation/Screenshot%20(421).png)\r\n    \r\n3.  **Intercept Request Chat Attacker**\r\n    \r\n    \r\n    -   Attacker mengirim pesan ke grup victim,\r\n    <br> \r\n    ![f](./documetation/Screenshot%20(441).png)\r\n\r\n    lalu tangkap request di Burp Suite dan simpan di Repeater dengan nama **\"attacker_send_chat\"** .\r\n    \r\n5.  **Manipulasi Request**\r\n    \r\n    -   Copy header request **\"attacker_send_chat\"** dan tempel ke header request **\"victim_clear_chat\"** .\r\n    -   Kirim request yang telah dimodifikasi.\r\n    -   Screenshot: Request yang telah dimodifikasi di Burp Repeater.\r\n    <br>\r\n    ![f](./documetation/Screenshot%20(421).png)\r\n\r\n6.  **Verifikasi**\r\n    \r\n    -   Reload halaman grup victim: **Chat grup victim terhapus** meskipun attacker tidak memiliki izin.\r\n    -   Screenshot: Chat grup punya victim kosong setelah exploit.\r\n    <br>\r\n    ![f](./documetation/Screenshot%20(440).png)\r\n----------\r\n<br>\r\n<br>\r\n\r\n## **2. IDOR - Update Role**\r\n\r\n**Endpoint** : `/update-role`  \r\n**Severity** : Critical\r\n\r\n### **Steps to Reproduce** :\r\n\r\n1.  **Persiapan**\r\n    \r\n    -   Victim membuat grup dan menambahkan attacker sebagai anggota (ID attacker: `1`).\r\n    -   Catat **group_id** milik victim dari URL detail group.\r\n    -   Screenshot: Group ID victim di URL.\r\n    <br>\r\n    ![f](./documetation/image.png)\r\n\r\n2.  **Attacker Update Role di Grupnya Sendiri**\r\n    \r\n    -   Attacker membuat grup dan mengubah role anggota dari \"member\" ke \"admin\".\r\n    -   Tangkap request di Burp Suite dan simpan di Repeater dengan nama **\"attacker_update_role\"** .\r\n    \r\n3.  **Manipulasi Request**\r\n    \r\n    -   Ubah parameter `group_id` ke **group_id victim** dan `user_id` ke **ID attacker** .\r\n    -   Kirim request yang telah dimodifikasi.\r\n    -   Screenshot: Request dengan group_id dan user_id yang diubah.\r\n    <br>\r\n    ![f](./documetation/Screenshot%20(425).png)\r\n    \r\n4.  **Verifikasi**\r\n    \r\n    -   Buka detail grup victim: Attacker sekarang memiliki role **admin** di grup victim.\r\n    -   Screenshot: Attacker sebagai admin di grup victim.\r\n    <br>\r\n    ![f](./documetation/Screenshot%20(427).png)\r\n----------\r\n\r\n## **3. IDOR - Update Group**\r\n\r\n**Endpoint** : `/update-group`  \r\n**Severity** : High\r\n\r\n### **Steps to Reproduce** :\r\n\r\n1.  **Victim Update Grup**\r\n    \r\n    -   Victim mengubah nama grupnya. Tangkap request di Burp Suite dan simpan body-nya.\r\n    -   Screenshot: Request update grup dari victim.\r\n    <br>\r\n    ![f](./documetation/Screenshot%20(423).png)\r\n    \r\n2.  **Attacker Update Grupnya Sendiri**\r\n    \r\n    -   Attacker mengubah nama grupnya sendiri. Tangkap request di Burp Suite dan simpan di Repeater dengan nama **\"attacker_update_group\"** .\r\n    \r\n3.  **Manipulasi Request**\r\n    \r\n    -   Ganti body request attacker dengan body request victim, lalu ubah `group_name` menjadi **\"hackbyattacker\"** .\r\n    -   Kirim request yang telah dimodifikasi.\r\n    -   Screenshot: Request yang dimodifikasi di Repeater.\r\n    <br>\r\n    ![f](./documetation/Screenshot%20(428).png)\r\n>>>>>>> a7101d347f306a97b93753238db01a6ba7e21b76\r\n\r\n4.  **Verifikasi**\r\n    \r\n    -   Nama grup victim berubah menjadi **\"hackbyattacker\"** .\r\n    -   Screenshot: Nama grup victim setelah diubah.\r\n    <br>\r\n    ![f](./documetation/Screenshot%20(430).png)\r\n----------\r\n\r\n## **4. IDOR - Delete Group**\r\n\r\n**Endpoint** : `/delete-group`  \r\n**Severity** : Critical\r\n\r\n### **Steps to Reproduce** :\r\n\r\n1.  **Attacker Delete Grup Sendiri**\r\n    \r\n    -   Attacker menghapus grupnya sendiri. Tangkap request di Burp Suite dan simpan di Repeater dengan nama **\"attacker_delete_group\"** .\r\n    \r\n2.  **Manipulasi Request**\r\n    \r\n    -   Ubah `group_id` ke **group_id victim** .\r\n    -   Kirim request yang telah dimodifikasi.\r\n    -   Screenshot: Request dengan group_id victim.\r\n    <br>\r\n    ![f](./documetation/Screenshot%20(442).png)\r\n    \r\n3.  **Verifikasi**\r\n    \r\n    -   Grup victim tidak lagi muncul di daftar grup.\r\n    -   Screenshot: Daftar grup victim yang kosong.\r\n    <br>\r\n    ![f](./documetation/Screenshot%20(433).png)\r\n----------\r\n\r\n## **5. IDOR - Add User to Group**\r\n\r\n**Endpoint** : `/add-user`  \r\n**Severity** : Medium\r\n\r\n### **Steps to Reproduce** :\r\n\r\n1.  **Attacker Menambahkan User ke Grupnya Sendiri**\r\n    \r\n    -   Attacker menambahkan user lain ke grupnya. Tangkap request di Burp Suite dan simpan di Repeater dengan nama **\"attacker_add_user\"** .\r\n    \r\n2.  **Manipulasi Request**\r\n    \r\n    -   Ubah `group_id` ke **group_id victim** .\r\n    -   Kirim request yang telah dimodifikasi.\r\n    -   Screenshot: Request dengan group_id victim.\r\n    <br>\r\n    ![f](./documetation/Screenshot%20(443).png)\r\n    \r\n3.  **Verifikasi**\r\n    \r\n    -   User yang ditambahkan muncul di grup victim.\r\n    -   Screenshot: User baru di grup victim.\r\n    <br>\r\n    ![f](./documetation/Screenshot%20(437).png)\r\n----------\r\n\r\n## **6. IDOR - Remove User from Group**\r\n\r\n**Endpoint** : `/remove-user`  \r\n**Severity** : Medium-High\r\n\r\n### **Steps to Reproduce** :\r\n\r\n1.  **Attacker Menghapus User dari Grupnya Sendiri**\r\n    \r\n    -   Attacker menghapus user dari grupnya. Tangkap request di Burp Suite dan simpan di Repeater dengan nama **\"attacker_delete_user\"** .\r\n    \r\n2.  **Manipulasi Request**\r\n    \r\n    -   Ubah `group_id` ke **group_id victim** .\r\n    -   Kirim request yang telah dimodifikasi.\r\n    -   Screenshot: Request dengan group_id victim.\r\n    <br>\r\n    ![f](./documetation/Screenshot%202025-03-09%20152314.png)\r\n\r\n3.  **Verifikasi**\r\n    \r\n    -   User yang ditargetkan hilang dari grup victim.\r\n    -   Screenshot: User tidak ada di grup victim.\r\n    <br>\r\n    ![f](./documetation/Screenshot%20(445).png) \r\n----------\r\n\r\n## **Impact**\r\n\r\n-   **Critical** : Attacker dapat mengambil alih grup, menghapus data, atau menaikkan hak akses.\r\n-   **High** : Perubahan data sensitif (nama grup, chat) tanpa izin.\r\n-   **Medium** : Manipulasi keanggotaan grup.\r\n\r\n----------\r\n\r\n## **Recommendation**\r\n\r\n1.  Validasi izin pengguna pada setiap endpoint sensitif (e.g., cek apakah user adalah admin grup).\r\n2.  Implementasi **server-side checks** untuk memastikan user hanya bisa mengakses resource yang dimilikinya.\r\n3.  Gunakan **UUID** sebagai pengganti ID numerik untuk mencegah IDOR.\r\n\r\n----------\r\n\r\n"
        }
    ]
}